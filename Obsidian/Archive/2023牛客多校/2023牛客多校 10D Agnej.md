---
link: "[23NC10D](https://ac.nowcoder.com/acm/contest/57364/D)"
done: true
tags:
  - game
  - nimber
---

显然每一层的游戏都是独立于其他层的，所以如果我们可以求出每一层的 SG 函数，我们就可以直接算出整个游戏的 SG 函数。

接下来，我们需要简化每一层的游戏。可以发现，每一层游戏的左半边和右半边（不含中间）的所有木块是分别等价的，因此每一层的状态可以用一个三元组 $(l,m,r)$ 表示，其中 $l$ 代表左半边木块数量，$m$ 代表中间是否存在木块，$r$ 代表右半边木块数量。

对于状态 $(l,m,r)$，我们每次操作可以从 $l$, $m$, $r$ 中拿走一个，直到 $(l,m,r)\in \{(1,0,1),(0,1,0)\}$。因为每个状态的操作方式非常有限，打表很容易就能找到规律，同时打表发现的规律也很容易通过数学归纳法证明。因此，我们对 $(l,m,r)$ 的 SG 函数 $G(l,m,r)$ 打表，可以发现：
1. 如果 $x=0$，则 $G(l,m,r)=l+r\bmod 2$。
2. 如果 $x=1$ 且 $\min(l,r)=0$，则 $G(l,m,r)=l+r\bmod 2$。
3. 如果 $x=1$ 且 $\min(l,r)=1$，则 $G(l,m,r)=2+(l+r\bmod 2)$。
4. 否则，$G(l,m,r)=l+r+1\bmod 2$。