---
dg-publish: false
done: false
tags:
  - graph
  - data-structure
---
# 圆方树

$
\newcommand{\ord}{\mathop{\rm ord}}
\newcommand{\low}{\mathop{\rm low}}
$考虑一个点双连通分量在原图中一棵生成树上的分布，我们发现它一定连续。

证明：如果点双在原图中不连续，考虑取两个同点双的点 $u,v$ 在树上的路径中，不在同一个点双里的点 $w$。显然，这个点到点双中的任何一个点都有两种点不同的路径，一条是 $w\to u\to \dots$，一条是 $w\to v\to\dots$，与 $w$ 不在点双中矛盾。

这在dfs序上和【点双连通分量最浅的点的子树在dfs序上连续】等价。观察一下点双连通分量在dfs序上的分布，可以发现 每个双连通分量在排除掉其子树的双连通分量后 在dfs序上是连续的

我们定义 **返祖边** 为图 $G$ 的有根生成树 $T$ 中，$u$ 结点在原图中的边指向其
我们观察 $\ord(u)$ 和 $\low(u)$，我们发现
1. 如果有桥，则没有返祖边指向桥以外的结点。
2. 如果是双连通分量，则每个点都指向桥的根。
3. 每个点双连通分量，在某个点指向其父亲时，即 $\low(v)=\ord(u)$ 时，栈的末尾一定是 $u$ 所在的 **部分** 连通分量 + 以 $v$ 为起点的 $v$ 所在的 **全部** 连通分量。因此，只要将栈 `pop` 到 $v$ 点，就处理完了 $v$ 和 $u$ 这条边所在的点双连通分量。
4. 如果 $u$ 是叶结点，那么其所有出边都是返祖边。

## 施工中

https://oi-wiki.org/graph/block-forest/