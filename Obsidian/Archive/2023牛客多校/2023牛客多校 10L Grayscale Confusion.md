---
Link: "[23NC10L](https://ac.nowcoder.com/acm/contest/57364/L)"
done: true
tags:
  - construction
---

我们用三元组 $(r_i,g_i,b_i)$ 表示颜色 $a_i$，同时我们用 $<$ 表示两个颜色 $a_i=(r_i,g_i,b_i)$，$a_j=(r_j,g_j,b_j)$ 之间 $r_i<r_j$，$g_i<g_j$ 且 $b_i<b_j$ 的关系。显然 $<$ 是一个严格偏序关系，则问题中的条件可以被重写为对于任意两个颜色 $a_i$, $a_j$，若 $a_i<a_j$ 则 $w_i<w_j$。则当 $a_1$ < $a_2$ 或 $a_2$ < $a_1$ 时答案不可能存在。

因为 $<$ 是严格偏序关系，颜色两两之间的关系形成一个有向无环图，我们可以对给定的颜色拓扑排序后直接赋值。如果 $w_i$ 没有值域限制，我们可以直接按照图的拓扑序给每个颜色赋值。但 $w_i$ 有值域限制，所以需要一些特殊的构造。

我们可以构造 ${\rm low}(a_i)=\min(r_i,g_i,b_i)$ 和 ${\rm high}(a_i)=\max(r_i,g_i,b_i)$，两个函数都满足题目中的条件，即若 $a_i<a_j$ 则 $w_i<w_j$。接下来，所有颜色 $a_i$ 可以被分为以下三种情况。
1. $a_1<a_i$ 或 $a_2<a_i$。这种情况下，我们希望 $w_i$ 尽可能大，所以我们令 $w_i$ 为 ${\rm high}(a_i)$。
2. $a_i<a_1$ or $a_i<a_2$。这种情况下，我们希望 $w_i$ 尽可能小，所以我们令 $w_i$ 为 ${\rm low}(a_i)$。
3. 否则，$w_i$ 不会影响 $w_1$ 和 $w_2$。$w_i$ 可以随意选择，不妨令 $w_i$ 为 ${\rm low}(a_i)$。

接下来，我们需要将 $w_1$ 和 $w_2$ 放入情况 1 中最小的 $w_i$ 和情况 2 中最大的 $w_j$ 之间。我们可以证明 $w_i-w_j>1$，因为：
- 情况 1 中所有的 $w_j>\min({\rm high}(a_1),{\rm high}(a_2))$。
- 情况 2 中所有的 $w_i<\max({\rm low}(a_1),{\rm low}(a_2))$。
- ${\rm high}(a_1)>{\rm low}(a_2)$，因为 ${\rm high}(a_1)<{\rm low}(a_2)$ 当且仅当 $a_1<a_2$。同样地，${\rm high}(a_2)<{\rm low}(a_1)$ 当且仅当 $a_2<a_1$。