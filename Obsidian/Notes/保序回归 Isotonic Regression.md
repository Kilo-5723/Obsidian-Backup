
## 问题形式

有 $n$ 个变量 $x_i$，每个变量有一个初始值 $a_i$。

有 $m$ 个限制条件 $(u,v)$，要求 $x_u\le x_v$。

求 $x_i$，使得 $x_i$ 满足所有限制条件，且 $\sum_{i=1}^n |x_i-a_i|^k$ 最小，$k\ge 1$。

## 解法

对于任意 $m$，假设所有点只能取值 $m$ 和 $m+1$，即 $x'_i\in\{m,m+1\}$，求方案。令 $L=\{i\mid x'_i=m\}$，$R=\{i\mid x'_i=m+1\}$，则一定存在一个最优方案 $x_i$ 使得 $\forall i\in L, x_i\le m$ 且 $\forall i\in R,x_i>m$。

因此可以整体二分，每次取当前值域 $[l,r)$ 的中点 $m$ 做上面的操作将点分成两类，然后分 $[l,m)$ 和 $[m,r)$ 两种情况递归。

时间复杂度 $O(\log W\cdot T_{\rm maxf}(n,m))$，其中 $W$ 是值域，$T_{\rm maxf}(n,m)$ 是 $n$ 个点 $m$ 条边的最大流的时间复杂度。

## 证明

有一个 $n$ 维凸空间 $S$，其边界为 $m$ 个限制条件 $x_u\le x_v$。

求凸空间内部的点的最小权重 $f(\vec{x})$，其中 $f(\vec{x})=\sum_{i=1}^n |x_i-a_i|^k$。

从 $\vec{x}=[m+0.5,\dots,m+0.5]$ 出发将 $S$ 分成 $2^n$ 块，找到其中梯度最低的一块